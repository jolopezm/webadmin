<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Gesti√≥n de Reportes ‚Äî Pymap</title>
        <link rel="stylesheet" href="../css/estilo.css" />
        <script type="module" src="../js/template-include.js"></script>
        <script type="module" src="../js/auth-guard.js"></script>
    </head>
    <body>
        <div class="app">
            <div id="sidebar-container"></div>

            <main class="main">
                <section class="card">
                    <div class="page-title">
                        <h1>Gesti√≥n de Reportes</h1>
                        <p>
                            Administra los reportes de usuarios sobre servicios.
                        </p>
                    </div>

                    <div class="metrics" style="margin-top: 16px">
                        <div class="metric">
                            <div class="num" id="total-reports">0</div>
                            <div class="label">Total reportes</div>
                        </div>
                        <div class="metric">
                            <div
                                class="num"
                                id="open-reports"
                                style="color: #f44336"
                            >
                                0
                            </div>
                            <div class="label">Abiertos</div>
                        </div>
                        <div class="metric">
                            <div
                                class="num"
                                id="in-progress-reports"
                                style="color: #ffc107"
                            >
                                0
                            </div>
                            <div class="label">En progreso</div>
                        </div>
                        <div class="metric">
                            <div
                                class="num"
                                id="resolved-reports"
                                style="color: #4caf50"
                            >
                                0
                            </div>
                            <div class="label">Resueltos</div>
                        </div>
                    </div>
                </section>

                <div class="content">
                    <div class="card" id="reports-card">
                        <h2
                            style="
                                margin: 0 0 12px;
                                font-size: 16px;
                                font-weight: 700;
                                color: var(--purple);
                            "
                        >
                            Lista de Reportes
                        </h2>

                        <div class="controls">
                            <select class="select" id="typeFilter">
                                <option value="all">Todos los tipos</option>
                                <option value="service_issue">
                                    Problema con servicio
                                </option>
                                <option value="payment_issue">
                                    Problema de pago
                                </option>
                                <option value="behavior_issue">
                                    Problema de comportamiento
                                </option>
                                <option value="technical_issue">
                                    Problema t√©cnico
                                </option>
                                <option value="other">Otro</option>
                            </select>

                            <select class="select" id="stateFilter">
                                <option value="all">Todos los estados</option>
                                <option value="open">Abierto</option>
                                <option value="in_progress">En progreso</option>
                                <option value="resolved">Resuelto</option>
                                <option value="closed">Cerrado</option>
                            </select>

                            <input
                                type="text"
                                class="input"
                                id="search"
                                placeholder="Buscar por email o descripci√≥n..."
                                style="flex: 1; min-width: 200px"
                            />

                            <button class="btn" id="refresh-btn">
                                üîÑ Actualizar
                            </button>

                            <select
                                class="select"
                                id="perPage"
                                style="margin-left: auto"
                            >
                                <option value="10" selected>
                                    10 por p√°gina
                                </option>
                                <option value="20">20 por p√°gina</option>
                                <option value="50">50 por p√°gina</option>
                            </select>
                        </div>

                        <div class="reports-list" id="reportsList"></div>

                        <div class="pagination" id="pagination"></div>
                    </div>

                    <!-- Sidebar derecho: Chats o Chat Activo -->
                    <div class="side-top" id="side-top">
                        <!-- Lista de Chats -->
                        <div class="card" id="chats-list-container">
                            <h3
                                style="
                                    margin: 0 0 12px;
                                    font-size: 14px;
                                    font-weight: 700;
                                    color: var(--purple);
                                "
                            >
                                Chats
                            </h3>
                            <div
                                id="chats-list"
                                style="
                                    display: flex;
                                    flex-direction: column;
                                    gap: 8px;
                                "
                            >
                                <!-- Lista de chats se cargar√° aqu√≠ -->
                            </div>
                        </div>

                        <!-- Chat Panel (superpuesto sobre la lista) -->
                        <div class="card" id="chat-panel" style="display: none">
                            <div class="chat-panel-header">
                                <h2
                                    style="
                                        margin: 0;
                                        font-size: 16px;
                                        font-weight: 700;
                                        color: var(--purple);
                                    "
                                >
                                    Chat
                                </h2>
                                <button class="btn ghost" id="close-chat-panel">
                                    ‚úï
                                </button>
                            </div>
                            <div class="chat-messages" id="chat-messages"></div>
                            <div class="chat-input-panel">
                                <textarea
                                    id="chat-input-text"
                                    placeholder="Escribe un mensaje..."
                                    rows="3"
                                ></textarea>
                                <button class="btn" id="send-chat-message">
                                    Enviar mensaje
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <div class="toast" id="toast" role="status" aria-live="polite"></div>

        <script type="module" src="../js/reports-main.js"></script>
    </body>
</html>
